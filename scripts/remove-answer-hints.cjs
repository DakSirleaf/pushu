const fs = require('fs');

const filePath = './public/data/questions.json';
const data = JSON.parse(fs.readFileSync(filePath, 'utf8'));

let fixCount = 0;

// Function to clean revealing parenthetical content from options
function cleanOption(option) {
  // Patterns to remove (revealing hints)
  const revealingPatterns = [
    /\s*\([^)]*irreversible[^)]*\)/gi,
    /\s*\([^)]*reversible[^)]*\)/gi,
    /\s*\([^)]*causes[^)]*\)/gi,
    /\s*\([^)]*requires[^)]*\)/gi,
    /\s*\([^)]*metabolized[^)]*\)/gi,
    /\s*\([^)]*safer[^)]*\)/gi,
    /\s*\([^)]*first-line[^)]*\)/gi,
    /\s*\([^)]*increases[^)]*\)/gi,
    /\s*\([^)]*decreases[^)]*\)/gi,
    /\s*\([^)]*associated[^)]*\)/gi,
    /\s*\([^)]*characteristic[^)]*\)/gi,
    /\s*\([^)]*worsen[^)]*\)/gi,
    /\s*\([^)]*evidence[^)]*\)/gi,
    /\s*\([^)]*warning[^)]*\)/gi,
    /\s*\([^)]*avoid[^)]*\)/gi,
    /\s*\([^)]*black box[^)]*\)/gi,
    /\s*\([^)]*contraindicated[^)]*\)/gi,
    /\s*\([^)]*treatment[^)]*\)/gi,
    /\s*\([^)]*therapeutic[^)]*\)/gi,
    /\s*\([^)]*inhibits[^)]*\)/gi,
    /\s*\([^)]*induces[^)]*\)/gi,
    /\s*\([^)]*toxicity[^)]*\)/gi,
    /\s*\([^)]*effective[^)]*\)/gi,
    /\s*\([^)]*depression[^)]*\)/gi,
    /\s*\([^)]*elevated[^)]*\)/gi,
    /\s*\([^)]*distinguishes[^)]*\)/gi,
    /\s*\([^)]*includes[^)]*\)/gi,
    /\s*\([^)]*ensures[^)]*\)/gi,
    /\s*\([^)]*inspires[^)]*\)/gi,
    /\s*\([^)]*focuses[^)]*\)/gi,
    /\s*\([^)]*learning[^)]*\)/gi,
    /\s*\([^)]*must[^)]*\)/gi,
    /\s*\([^)]*should[^)]*\)/gi,
    /\s*\([^)]*allows[^)]*\)/gi,
    /\s*\([^)]*prevents[^)]*\)/gi,
    /\s*\([^)]*truthful[^)]*\)/gi,
    /\s*\([^)]*chronic[^)]*\)/gi,
    /\s*\([^)]*acute[^)]*\)/gi,
    /\s*\([^)]*differ[^)]*\)/gi,
    /\s*\([^)]*different[^)]*\)/gi,
    /\s*\([^)]*slow[^)]*\)/gi,
    /\s*\([^)]*block[^)]*\)/gi,
    /\s*\([^)]*enhance[^)]*\)/gi,
    /\s*\([^)]*sensitivity[^)]*\)/gi,
    /\s*\([^)]*specificity[^)]*\)/gi,
    /\s*\([^)]*true positive[^)]*\)/gi,
    /\s*\([^)]*females[^)]*\)/gi,
    /\s*\([^)]*males[^)]*\)/gi,
    /\s*\([^)]*law[^)]*\)/gi,
    /\s*\([^)]*legislature[^)]*\)/gi,
    /\s*\([^)]*teratogenic[^)]*\)/gi,
    /\s*\([^)]*risk[^)]*\)/gi,
    /\s*\([^)]*reason[^)]*\)/gi,
    /\s*\([^)]*ambivalent[^)]*\)/gi,
    /\s*\([^)]*thinking[^)]*\)/gi,
    /\s*\([^)]*actively[^)]*\)/gi,
    /\s*\([^)]*not thinking[^)]*\)/gi,
    /\s*\([^)]*hearing[^)]*\)/gi,
    /\s*\([^)]*comprehension[^)]*\)/gi,
    /\s*\([^)]*memory[^)]*\)/gi,
    /\s*\([^)]*patient's[^)]*\)/gi,
    /\s*\([^)]*therapist's[^)]*\)/gi,
    /\s*\([^)]*additions[^)]*\)/gi,
    /\s*\([^)]*hallucinations[^)]*\)/gi,
    /\s*\([^)]*delusions[^)]*\)/gi,
    /\s*\([^)]*right to[^)]*\)/gi,
    /\s*\([^)]*with notice[^)]*\)/gi,
    /\s*\([^)]*beneficence[^)]*\)/gi,
    /\s*\([^)]*autonomy[^)]*\)/gi,
    /\s*\([^)]*justice[^)]*\)/gi,
    /\s*\([^)]*hypomania[^)]*\)/gi,
    /\s*\([^)]*manic[^)]*\)/gi,
    /\s*\([^)]*subcortical[^)]*\)/gi,
    /\s*\([^)]*additive[^)]*\)/gi,
    /\s*\([^)]*serotonin[^)]*\)/gi,
    /\s*\([^)]*no serotonin[^)]*\)/gi,
    /\s*\([^)]*antihistamine[^)]*\)/gi,
    /\s*\([^)]*induce[^)]*\)/gi,
    /\s*\([^)]*off-label[^)]*\)/gi,
    /\s*\([^)]*mastication[^)]*\)/gi,
    /\s*\([^)]*facial[^)]*\)/gi,
    /\s*\([^)]*expressions[^)]*\)/gi,
    /\s*\([^)]*replacement[^)]*\)/gi,
    /\s*\([^)]*involuntary[^)]*\)/gi,
    /\s*\([^)]*dopamine[^)]*\)/gi,
    /\s*\([^)]*muscle[^)]*\)/gi,
    /\s*\([^)]*restlessness[^)]*\)/gi,
    /\s*\([^)]*absence[^)]*\)/gi,
    /\s*\([^)]*fever[^)]*\)/gi,
    /\s*\([^)]*rigidity[^)]*\)/gi,
    /\s*\([^)]*tachycardia[^)]*\)/gi,
    /\s*\([^)]*agitation[^)]*\)/gi,
    /\s*\([^)]*hyperthermia[^)]*\)/gi,
    /\s*\([^)]*hyperreflexia[^)]*\)/gi,
    /\s*\([^)]*bradycardia[^)]*\)/gi,
    /\s*\([^)]*arrhythmia[^)]*\)/gi,
    /\s*\([^)]*hypotension[^)]*\)/gi,
    /\s*\([^)]*executive[^)]*\)/gi,
    /\s*\([^)]*visuospatial[^)]*\)/gi,
    /\s*\([^)]*alpha-2[^)]*\)/gi,
    /\s*\([^)]*weight gain[^)]*\)/gi,
    /\s*\([^)]*weight loss[^)]*\)/gi,
    /\s*\([^)]*weight-neutral[^)]*\)/gi,
    /\s*\([^)]*may cause[^)]*\)/gi,
    /\s*\([^)]*raising[^)]*\)/gi,
    /\s*\([^)]*reducing[^)]*\)/gi,
    /\s*\([^)]*viewing[^)]*\)/gi,
    /\s*\([^)]*tests[^)]*\)/gi,
    /\s*\([^)]*liver[^)]*\)/gi,
    /\s*\([^)]*FDA[^)]*\)/gi,
    /\s*\([^)]*run in[^)]*\)/gi,
    /\s*\([^)]*families[^)]*\)/gi,
    /\s*\([^)]*stressor[^)]*\)/gi,
    /\s*\([^)]*days to[^)]*\)/gi,
    /\s*\([^)]*month[^)]*\)/gi,
    /\s*\([^)]*BMI[^)]*\)/gi,
    /\s*\([^)]*medical[^)]*\)/gi,
    /\s*\([^)]*poop-out[^)]*\)/gi,
    /\s*\([^)]*substantia[^)]*\)/gi,
    /\s*\([^)]*basal[^)]*\)/gi,
    /\s*\([^)]*sleep[^)]*\)/gi,
    /\s*\([^)]*neonatal[^)]*\)/gi,
    /\s*\([^)]*Current[^)]*\)/gi,
    /\s*\([^)]*Terminology[^)]*\)/gi,
    /\s*\([^)]*odd[^)]*eccentric[^)]*\)/gi,
    /\s*\([^)]*dramatic[^)]*emotional[^)]*\)/gi,
    /\s*\([^)]*anxious[^)]*fearful[^)]*\)/gi,
    /\s*\([^)]*ANC[^)]*\)/gi,
    /\s*\([^)]*discontinuation[^)]*\)/gi,
    /\s*\([^)]*lethal[^)]*\)/gi,
    /\s*\([^)]*secure[^)]*\)/gi,
    /\s*\([^)]*remove[^)]*\)/gi,
    /\s*\([^)]*screen[^)]*\)/gi,
    /\s*\([^)]*educate[^)]*\)/gi,
    /\s*\([^)]*academic[^)]*\)/gi,
    /\s*\([^)]*behavioral[^)]*\)/gi,
    /\s*\([^)]*strengths[^)]*\)/gi,
    /\s*\([^)]*competencies[^)]*\)/gi,
    /\s*\([^)]*experience[^)]*\)/gi,
    /\s*\([^)]*identifiable[^)]*\)/gi,
    /\s*\([^)]*potential[^)]*\)/gi,
    /\s*\([^)]*victim[^)]*\)/gi,
    /\s*\([^)]*PPI[^)]*\)/gi,
    /\s*\([^)]*CYP[^)]*\)/gi,
    /\s*\([^)]*clonus[^)]*\)/gi,
    /\s*\([^)]*lead-pipe[^)]*\)/gi,
    /\s*\([^)]*significant[^)]*\)/gi,
    /\s*\([^)]*face-to-face[^)]*\)/gi,
    /\s*\([^)]*indirect[^)]*\)/gi,
    /\s*\([^)]*documentation[^)]*\)/gi,
    /\s*\([^)]*coordination[^)]*\)/gi,
    /\s*\([^)]*HCG[^)]*\)/gi,
    /\s*\([^)]*Ebstein[^)]*\)/gi,
    /\s*\([^)]*neural[^)]*\)/gi,
    /\s*\([^)]*tube[^)]*\)/gi,
    /\s*\([^)]*defects[^)]*\)/gi,
    /\s*\([^)]*elevated TSH[^)]*\)/gi,
    /\s*\([^)]*repetitive[^)]*\)/gi,
    /\s*\([^)]*movements[^)]*\)/gi,
    /\s*\([^)]*paranoid[^)]*\)/gi,
    /\s*\([^)]*schizoid[^)]*\)/gi,
    /\s*\([^)]*schizotypal[^)]*\)/gi,
    /\s*\([^)]*narcissistic[^)]*\)/gi,
    /\s*\([^)]*borderline[^)]*\)/gi,
    /\s*\([^)]*histrionic[^)]*\)/gi,
    /\s*\([^)]*antisocial[^)]*\)/gi,
    /\s*\([^)]*avoidant[^)]*\)/gi,
    /\s*\([^)]*dependent[^)]*\)/gi,
    /\s*\([^)]*OCPD[^)]*\)/gi,
    /\s*\([^)]*ovarian[^)]*\)/gi,
    /\s*\([^)]*failure[^)]*\)/gi,
    /\s*\([^)]*45,XO[^)]*\)/gi,
    /\s*\([^)]*spina bifida[^)]*\)/gi,
    /\s*\([^)]*especially[^)]*\)/gi,
    /\s*\([^)]*dementia[^)]*\)/gi,
    /\s*\([^)]*high school[^)]*\)/gi,
    /\s*\([^)]*sensitive[^)]*\)/gi,
    /\s*\([^)]*indicator[^)]*\)/gi,
    /\s*\([^)]*emergency[^)]*\)/gi,
    /\s*\([^)]*less sedating[^)]*\)/gi,
    /\s*\([^)]*preferred[^)]*\)/gi,
    /\s*\([^)]*daytime[^)]*\)/gi,
    /\s*\([^)]*Glossopharyngeal[^)]*\)/gi,
    /\s*\([^)]*neuropsychiatric[^)]*\)/gi,
    /\s*\([^)]*irritability[^)]*\)/gi,
    /\s*\([^)]*outbursts[^)]*\)/gi,
    /\s*\([^)]*DMDD[^)]*\)/gi,
    /\s*\([^)]*glucuronidation[^)]*\)/gi,
  ];

  let cleaned = option;
  for (const pattern of revealingPatterns) {
    cleaned = cleaned.replace(pattern, '');
  }

  // Clean up any double spaces or trailing spaces
  cleaned = cleaned.replace(/\s+/g, ' ').trim();

  return cleaned;
}

// Process all questions
data.forEach(q => {
  q.options = q.options.map((opt, i) => {
    const cleaned = cleanOption(opt);
    if (cleaned !== opt) {
      console.log(`Q${q.id} Opt${i}: "${opt.substring(0, 50)}..." â†’ "${cleaned.substring(0, 50)}..."`);
      fixCount++;
    }
    return cleaned;
  });
});

fs.writeFileSync(filePath, JSON.stringify(data, null, 2));
console.log(`\n=== TOTAL OPTIONS CLEANED: ${fixCount} ===`);
